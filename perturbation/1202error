/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
2024-12-03 03:45:49.641192: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  %pad.1 = bf16[40962,1,474]{2,1,0} pad(bf16[40962,1,3]{2,1,0} %constant.348, bf16[] %constant.349), padding=0_0x0_0x471_0, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/concatenate[dimension=2]" source_file="/home/hiskim1/his_graphcast/graphcast/graphcast.py" source_line=645}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2024-12-03 03:45:49.645098: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.004036921s
Constant folding an instruction is taking > 1s:

  %pad.1 = bf16[40962,1,474]{2,1,0} pad(bf16[40962,1,3]{2,1,0} %constant.348, bf16[] %constant.349), padding=0_0x0_0x471_0, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/concatenate[dimension=2]" source_file="/home/hiskim1/his_graphcast/graphcast/graphcast.py" source_line=645}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
2024-12-03 12:27:14.196736: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  %pad.1 = bf16[40962,1,474]{2,1,0} pad(bf16[40962,1,3]{2,1,0} %constant.348, bf16[] %constant.349), padding=0_0x0_0x471_0, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/concatenate[dimension=2]" source_file="/home/hiskim1/his_graphcast/graphcast/graphcast.py" source_line=645}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2024-12-03 12:27:14.685954: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.489579822s
Constant folding an instruction is taking > 1s:

  %pad.1 = bf16[40962,1,474]{2,1,0} pad(bf16[40962,1,3]{2,1,0} %constant.348, bf16[] %constant.349), padding=0_0x0_0x471_0, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/concatenate[dimension=2]" source_file="/home/hiskim1/his_graphcast/graphcast/graphcast.py" source_line=645}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
/home/hiskim1/.conda/envs/hiskim1_graphcast/lib/python3.11/site-packages/xarray/backends/plugins.py:80: RuntimeWarning: Engine 'cfgrib' loading failed:
Cannot find the ecCodes library
  warnings.warn(f"Engine {name!r} loading failed:\n{ex}", RuntimeWarning)
WARNING:absl:Skipping gradient checkpointing for sequence length of 1
